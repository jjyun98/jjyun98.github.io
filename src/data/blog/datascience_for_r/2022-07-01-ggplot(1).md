---
author: Jo YunHo
pubDatetime: 2022-07-01T10:00:00Z
modDatetime: 2025-01-17T15:00:00Z
title: ggplot2 기초 가이드 - R 데이터 시각화 완전정복 (1)
slug: "ggplot2-basics-data-visualization"
featured: true
draft: false
tags:
  - R
  - Data Visualization
  - ggplot2
  - Statistics
description: "R의 ggplot2 패키지를 활용한 데이터 시각화 기초부터 고급 기법까지. aes, facet, geom, mapping, filter 등 핵심 개념을 실습 예제와 함께 체계적으로 학습합니다."
---

> 📌 참고 자료:  
> [ggplot2 공식 문서](https://ggplot2.tidyverse.org/) | [R for Data Science](https://r4ds.had.co.nz/)

## Table of contents

## 개요

**ggplot2**는 R에서 가장 강력하고 널리 사용되는 데이터 시각화 패키지입니다. 이번 포스팅에서는 ggplot2의 핵심 개념인 **aes(aesthetic mapping)**, **facet**, **geom**, **mapping**, **filter** 등을 실습 예제와 함께 체계적으로 알아보겠습니다.

Grammar of Graphics 철학을 바탕으로 한 ggplot2의 레이어 시스템을 이해하고, 다양한 시각화 기법을 마스터해보세요!

## 1. 환경 설정 및 라이브러리 로드

### 필수 패키지 설치 및 로드

```r
# 패키지 로드
library('tidyverse')  # ggplot2 포함
library('maps')       # 지도 데이터

# 플롯 최적화 설정
options(
  repr.plot.width = 8,    # 너비 설정
  repr.plot.height = 5,   # 높이 설정  
  repr.plot.res = 150     # 해상도 설정
)

# 테마 설정 (깔끔한 스타일)
theme_set(theme_minimal(base_size = 10))
```

## 2. aes (Aesthetic Mapping) 옵션들

**aes()**는 데이터의 변수를 시각적 속성에 매핑하는 핵심 함수입니다.

### 색상 매핑 (color)

```r
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, color = class))
```

![color mapping example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_6_0.png)

**클래스별로 다른 색상**이 자동으로 할당되어 데이터의 그룹을 쉽게 구분할 수 있습니다.

### 크기 매핑 (size)

```r
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, size = class))
```

![size mapping example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_8_1.png)

#### ⚠️ 주의사항
이산형 변수에 size 매핑을 사용하면 경고가 발생합니다. 연속형 변수에 사용하는 것이 좋습니다.

### 투명도 매핑 (alpha)

```r
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, alpha = class))
```

![alpha mapping example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_10_1.png)

### 모양 매핑 (shape)

```r
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, shape = class))
```

![shape mapping example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_12_1.png)

#### ✅ 중요 팁
shape는 최대 6개의 그룹까지만 구분 가능합니다. 그 이상은 일부 데이터가 표시되지 않습니다.

### 고정 속성 설정

```r
# aes 밖에서 설정하면 모든 점에 동일하게 적용
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy), color = 'blue')
```

![fixed color example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_13_0.png)

## 3. Facet (면분할) - 데이터 분할 시각화

### facet_wrap(): 단일 변수 기준 분할

```r
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_wrap(~ class, nrow = 3)
```

![facet wrap example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_17_0.png)

**차량 클래스별로 분리된 플롯**을 생성하여 각 그룹의 패턴을 개별적으로 관찰할 수 있습니다.

### facet_grid(): 두 변수 기준 격자 분할

```r
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_grid(drv ~ cyl)
```

![facet grid example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_20_0.png)

**구동 방식(drv)과 실린더 수(cyl)**의 조합으로 격자 형태의 플롯을 생성합니다.

### 📌 데이터 탐색

```r
# 구동 방식 확인
mpg$drv %>% unique()  # "f", "4", "r"

# 실린더 수 확인  
mpg$cyl %>% unique()  # 4, 6, 8, 5
```

### 단방향 분할

```r
# 열만 분할 (행은 통합)
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_grid(. ~ cyl)
```

![single direction facet](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_27_0.png)

## 4. geom (기하학적 객체) 옵션들

**geom**은 데이터를 어떤 형태로 표현할지 결정하는 핵심 요소입니다.

### geom_smooth(): 평활선 추가

```r
ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy))
```

![smooth line example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_32_1.png)

**LOESS 회귀선**이 자동으로 추가되어 전체적인 트렌드를 파악할 수 있습니다.

### 라인 타입으로 그룹 구분

```r
ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy, linetype = drv))
```

![linetype example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_34_1.png)

### 색상으로 그룹 구분

```r
ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy, color = drv))
```

![colored smooth example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_38_1.png)

### 포인트와 스무딩 결합

```r
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, color = drv)) +
  geom_smooth(mapping = aes(x = displ, y = hwy, color = drv, linetype = drv))
```

![combined plot example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_40_1.png)

### geom_bar(): 막대 그래프

```r
ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut))
```

![bar chart example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_42_0.png)

## 5. 매핑 최적화 기법

### 전역 매핑 설정

```r
# ggplot()에서 공통 매핑 설정
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point() +
  geom_smooth()
```

![global mapping example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_45_1.png)

### 선택적 매핑 추가

```r
# 전역 매핑 + 개별 레이어 매핑
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point(mapping = aes(color = class)) +  # 포인트만 색상 구분
  geom_smooth()  # 전체 데이터로 스무딩
```

![selective mapping example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_47_1.png)

## 6. 필터링 활용

### 특정 그룹만 스무딩

```r
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point(mapping = aes(color = class)) +
  geom_smooth(
    data = filter(mpg, class == 'subcompact'),  # 서브컴팩트만 필터링
    se = FALSE  # 신뢰구간 제거
  )
```

![filtered smooth example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_50_1.png)

## 7. 통계 변환 (Statistical Transformations)

### 사용자 정의 데이터로 막대 그래프

```r
# 커스텀 데이터 생성
demo <- tribble(
  ~cut, ~freq,
  "Fair", 1610,
  "Good", 4906,
  "Very Good", 12082,
  "Premium", 13791,
  "Ideal", 21551
)

# stat = 'identity'로 실제 값 사용
ggplot(data = demo) +
  geom_bar(mapping = aes(x = cut, y = freq), stat = 'identity')
```

![custom data bar example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_58_0.png)

### 비율 표시

```r
ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, y = after_stat(prop), group = 1))
```

![proportion bar example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_60_1.png)

### stat_summary(): 통계 요약

```r
ggplot(data = diamonds) +
  stat_summary(
    mapping = aes(x = cut, y = depth),
    fun.min = min,    # 최솟값
    fun.max = max,    # 최댓값
    fun = median      # 중앙값
  )
```

![stat summary example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_62_1.png)

## 8. 색상과 채우기 (Color vs Fill)

### color vs fill 차이점

```r
# 테두리 색상
ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, color = cut))

# 내부 채우기 색상  
ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, fill = cut))
```

![color vs fill example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_65_0.png)

### 그룹별 적층 막대

```r
ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, fill = clarity))
```

![stacked bar example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_67_0.png)

## 9. 위치 조정 (Position Adjustments)

### position = 'identity': 원래 위치

```r
ggplot(data = diamonds, mapping = aes(x = cut, fill = clarity)) +
  geom_bar(alpha = 0.3, position = 'identity')
```

![position identity example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_70_0.png)

### position = 'fill': 비율 비교

```r
ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, fill = clarity), position = 'fill')
```

![position fill example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_74_0.png)

### position = 'dodge': 나란히 배치

```r
ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, fill = clarity), position = 'dodge')
```

![position dodge example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_76_0.png)

### position = 'jitter': 점 분산

```r
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy), position = 'jitter')
```

![jitter example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_79_0.png)

**겹치는 점들을 약간 분산**시켜 데이터 밀도를 더 잘 보여줍니다.

## 10. 좌표계 변환

### coord_flip(): 축 뒤집기

```r
# 기본 박스플롯
ggplot(data = mpg, mapping = aes(x = class, y = hwy)) +
  geom_boxplot()

# 축 뒤집기  
ggplot(data = mpg, mapping = aes(x = class, y = hwy)) + 
  geom_boxplot() +
  coord_flip()
```

![coord flip example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_81_0.png)

## 11. 지도 시각화

### 기본 지도 그리기

```r
# 뉴질랜드 지도 데이터
nz <- map_data('nz')

ggplot(nz, aes(long, lat, group = group)) +
  geom_polygon(fill = 'white', color = 'black')
```

![basic map example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_84_0.png)

### coord_quickmap(): 비율 보정

```r
ggplot(nz, aes(long, lat, group = group)) + 
  geom_polygon(fill = 'white', color = 'black') +
  coord_quickmap()  # 지도 비율 보정
```

![quickmap example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_86_0.png)

## 12. 극좌표와 파이 차트

### 막대 그래프를 파이 차트로 변환

```r
# 기본 막대 그래프 설정
bar <- ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, fill = cut), 
           show.legend = FALSE, width = 1) +
  theme(aspect.ratio = 1) +
  labs(x = NULL, y = NULL)

# 축 뒤집기
bar + coord_flip()
```

![flipped bar example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_88_0.png)

### coord_polar(): 파이 차트 생성

```r
bar + coord_polar()
```

![pie chart example](@/assets/images/2022-07-01-ggplot1_files/2022-07-01-ggplot1_90_0.png)

## 💡 ggplot2 활용 팁

### ✅ 효율적인 코딩 습관
1. **전역 매핑 활용**: 공통 매핑은 `ggplot()`에서 설정
2. **레이어별 특성**: 개별 레이어에만 필요한 매핑은 해당 `geom`에서 설정
3. **일관된 테마**: `theme_set()`으로 프로젝트 전체 스타일 통일

### 📊 시각화 선택 가이드
- **관계 탐색**: `geom_point()` + `geom_smooth()`
- **분포 비교**: `geom_boxplot()`, `geom_violin()`
- **범주형 데이터**: `geom_bar()`, `geom_col()`
- **시계열 데이터**: `geom_line()`, `geom_area()`

### 🎨 색상과 스타일링
- **color**: 테두리나 선의 색상
- **fill**: 내부 채우기 색상  
- **alpha**: 투명도 (0~1)
- **position**: 요소들의 배치 방식

## 마무리

**ggplot2**는 Grammar of Graphics 철학을 바탕으로 한 강력한 시각화 도구입니다. 이번 포스팅에서 다룬 핵심 개념들을 정리하면:

- **aes()**: 데이터 변수를 시각적 속성에 매핑
- **facet**: 데이터를 그룹별로 분할하여 시각화
- **geom**: 데이터의 기하학적 표현 방식 결정  
- **position**: 요소들의 배치 방식 조정
- **coord**: 좌표계 변환으로 다양한 뷰 제공

이러한 **레이어 시스템**을 이해하고 조합하면, 단순한 산점도부터 복잡한 다변량 시각화까지 자유자재로 구현할 수 있습니다.

**실무에서는 데이터의 특성과 전달하고자 하는 메시지에 따라 적절한 geom과 aes 조합을 선택하는 것이 중요**합니다. 많은 연습을 통해 ggplot2의 문법을 체화하고, 데이터 스토리텔링의 달인이 되어보세요!

다음 포스팅에서는 **고급 ggplot2 기법**과 **interactive visualization**에 대해 다뤄보겠습니다. 📈